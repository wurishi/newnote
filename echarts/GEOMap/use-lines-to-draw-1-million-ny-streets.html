<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta charset="UTF-8" />
    <script src="../node_modules/echarts/dist/echarts.min.js"></script>
    <script src="../d3.v5.js"></script>
    <script src="../bmap.js"></script>
    <script src="../api.js"></script>
  </head>
  <body>
    <div id="main"></div>
    <script>
      // const width = 640;
      // const height = 480;
      // const main = document.getElementById('main');
      // main.style.width = `${width}px`;
      // main.style.height = `${height}px`;

      // let CHUNK_COUNT = 32;
      // let dataCount = 0;
      // function fetchData(idx) {
      //   if (idx >= CHUNK_COUNT) {
      //     return;
      //   }

      //   // const host = 'http://127.0.0.1:8080/GEOMap/'
      //   const url = `./bins/links_ny_${idx}.bin`;
      //   // console.log(url);
      //   const xhr = new XMLHttpRequest();
      //   xhr.open('GET', url, true);
      //   xhr.responseType = 'arraybuffer';
      //   xhr.onload = function (e) {
      //     const rawData = new Float32Array(this.response);
      //     const data = new Float64Array(rawData.length - 2);
      //     const offsetX = rawData[0];
      //     const offsetY = rawData[1];
      //     let off = 0;
      //     let addedDataCount = 0;
      //     for (let i = 2; i < rawData.length; ) {
      //       const count = rawData[i++];
      //       data[off++] = count;
      //       for (let k = 0; k < count; k++) {
      //         const x = rawData[i++] + offsetX;
      //         const y = rawData[i++] + offsetY;
      //         data[off++] = x;
      //         data[off++] = y;
      //         addedDataCount++;
      //       }
      //     }

      //     myChart.appendData({
      //       seriesIndex: 0,
      //       data: data,
      //     });
      //     dataCount += addedDataCount;
      //     fetchData(idx + 1);
      //   };

      //   xhr.send();
      // }

      // const myChart = echarts.init(main);
      // const option = {
      //   title: {
      //     text: 'Use Lines to Draw 1 Million ny Streets',
      //   },
      //   toolbox: {
      //     feature: {
      //       saveAsImage: {},
      //     },
      //   },
      //   progressive: 20000,
      //   backgroundColor: '#111',
      //   geo: {
      //     center: [-74.04327099998152, 40.86737600240287],
      //     zoom: 360,
      //     map: 'world',
      //     roam: true,
      //     silent: true,
      //     itemStyle: {
      //       color: 'transparent',
      //       borderColor: 'rgba(255,255,255,0.1)',
      //       borderWidth: 1,
      //     },
      //   },
      //   // xAxis: {},
      //   // yAxis: {},
      //   series: [
      //     {
      //       type: 'lines',
      //       coordinateSystem: 'geo',
      //       blendMode: 'lighter',
      //       dimensions: ['value'],
      //       data: new Float64Array(),
      //       polyline: true,
      //       large: true,
      //       lineStyle: {
      //         color: 'orange',
      //         width: 0.5,
      //         opacity: 0.3,
      //       },
      //     },
      //   ],
      // };
      // myChart.setOption(option);

      // fetchData(0);
    </script>
  </body>
</html>
